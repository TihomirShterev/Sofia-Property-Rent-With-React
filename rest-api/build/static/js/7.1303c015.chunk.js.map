{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","pages/create/index.module.css","pages/create/index.js"],"names":["_arrayLikeToArray","arr","len","length","i","arr2","Array","_slicedToArray","isArray","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","err","o","minLen","n","prototype","toString","call","slice","constructor","name","from","test","TypeError","module","exports","CreatePage","useState","title","setTitle","imageURL","setImageURL","description","setDescription","titleError","setTitleError","imageURLError","setImageURLError","descriptionError","setDescriptionError","context","useContext","UserContext","history","useHistory","handleSubmit","event","a","preventDefault","fetch","method","body","JSON","stringify","headers","getCookie","uploadImage","e","files","target","data","FormData","append","res","json","file","secure_url","titleErrorMessage","imageURLErrorMessage","descriptionErrorMessage","className","styles","onSubmit","htmlFor","red","type","onChange","id","error","src","style","width","alt","rows","public","loggedIn","to"],"mappings":"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","file":"static/js/7.1303c015.chunk.js","sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithHoles from \"@babel/runtime/helpers/esm/arrayWithHoles\";\nimport iterableToArrayLimit from \"@babel/runtime/helpers/esm/iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableRest from \"@babel/runtime/helpers/esm/nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"new-item-border\":\"create_new-item-border__3HkTK\",\"input\":\"create_input__3f0oi\",\"header-background\":\"create_header-background__3uwdi\",\"title\":\"create_title__10whB\",\"new-item-content\":\"create_new-item-content__WiuiB\",\"new-item-title\":\"create_new-item-title__26eov\",\"new-item-image\":\"create_new-item-image__3P4kQ\",\"new-item-buttons\":\"create_new-item-buttons__2wXL-\",\"error\":\"create_error__c_tX8\",\"input-error\":\"create_input-error__fc-DE\"};","import React, { useContext, useState } from 'react';\r\nimport { Redirect, useHistory } from 'react-router-dom';\r\nimport UserContext from '../../Context';\r\nimport Layout from '../../components/layout';\r\nimport styles from './index.module.css';\r\nimport getCookie from '../../utils/cookie';\r\n\r\nconst CreatePage = () => {\r\n  const [title, setTitle] = useState('');\r\n  const [imageURL, setImageURL] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [titleError, setTitleError] = useState(false);\r\n  const [imageURLError, setImageURLError] = useState(false);\r\n  const [descriptionError, setDescriptionError] = useState(false);\r\n  const context = useContext(UserContext);\r\n  const history = useHistory();\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n\r\n    // TODO: validations\r\n    if (title.length < 5) {\r\n      setTitleError(true);\r\n    } else {\r\n      setTitleError(false);\r\n    }\r\n\r\n    if (!imageURL) {\r\n      setImageURLError(true);\r\n    } else {\r\n      setImageURLError(false);\r\n    }\r\n\r\n    if (description.length < 10) {\r\n      setDescriptionError(true);\r\n    } else {\r\n      setDescriptionError(false);\r\n    }\r\n\r\n    if (title.length >= 5 && imageURL && description.length >= 10) {\r\n      // const promise = await fetch('https://estatesbg.herokuapp.com/api/items/create', {\r\n      await fetch('https://estatesbg.herokuapp.com/api/items/create', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          title,\r\n          imageURL,\r\n          description\r\n        }),\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': getCookie('auth-cookie')\r\n        }\r\n      });\r\n\r\n      // const data = await promise.json();\r\n      // console.log(data);\r\n\r\n      history.push('/item');\r\n    }\r\n  };\r\n\r\n  const uploadImage = async (e) => {\r\n    const files = e.target.files;\r\n    const data = new FormData();\r\n    data.append('file', files[0]);\r\n    data.append('upload_preset', 'sofiapropertyrent');\r\n\r\n    const res = await fetch(\"https://api.cloudinary.com/v1_1/tyscloud/image/upload\",\r\n      {\r\n        method: 'POST',\r\n        body: data\r\n      });\r\n\r\n    const file = await res.json();\r\n    // console.log(file);\r\n    setImageURL(file.secure_url);\r\n  };\r\n\r\n  const titleErrorMessage = titleError ? 'Please enter a valid title consisting at least 5 characters' : null;\r\n  const imageURLErrorMessage = imageURLError ? 'Please upload a valid image' : null;\r\n  const descriptionErrorMessage = descriptionError ? 'Please enter a valid description consisting at least 10 characters' : null;\r\n\r\n  return (\r\n    <Layout>\r\n\r\n      <div className={styles[\"new-item-border\"]}>\r\n\r\n        <div className={styles[\"header-background\"]}>\r\n          <span>CREATE OFFER</span>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div className={styles[\"new-item-title\"]}>\r\n            <label htmlFor=\"title\">Title: <span className={styles.red}></span></label>\r\n            <input\r\n              type=\"text\"\r\n              value={title}\r\n              onChange={(e) => setTitle(e.target.value)}\r\n              name=\"title\"\r\n              id=\"title\" />\r\n            <p className={styles.error}>\r\n              {titleErrorMessage}\r\n            </p>\r\n          </div>\r\n          <div className={styles[\"new-item-image\"]}>\r\n            {imageURL ? (<img src={imageURL} style={{ width: '300px' }} alt=\"\" />) : null}\r\n            <input\r\n              type=\"file\"\r\n              name=\"imageURL\"\r\n              onChange={uploadImage}\r\n            />\r\n            <p className={styles.error}>\r\n              {imageURLErrorMessage}\r\n            </p>\r\n          </div>\r\n          <div className={styles[\"new-item-content\"]}>\r\n            <label htmlFor=\"description\">Description: <span className={styles.red}></span></label>\r\n            <textarea\r\n              type=\"text\"\r\n              value={description}\r\n              onChange={(e) => setDescription(e.target.value)}\r\n              name=\"description\"\r\n              id=\"description\"\r\n              rows=\"8\"\r\n              className=\"height\"\r\n            ></textarea>\r\n            <p className={styles.error}>\r\n              {descriptionErrorMessage}\r\n            </p>\r\n          </div>\r\n          <div className={styles[\"new-item-buttons\"]}>\r\n            {/* <button type=\"button\" className={styles.cancel} href=\"/\">Back</button> */}\r\n            <button className={styles.public} type=\"submit\">Create</button>\r\n          </div>\r\n        </form>\r\n\r\n      </div>\r\n      {/* auth \"guard\" */}\r\n      { context.loggedIn ? null : <Redirect to=\"/user/login\" />}\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default CreatePage;"],"sourceRoot":""}